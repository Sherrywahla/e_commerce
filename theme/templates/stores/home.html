{% extends '../base.html' %}
{% load static %}
{% block title %} Sherry Retail | Home {% endblock %}
{% block content %}
  <div>
    <div>
      <div id="default-carousel" class="relative w-full" data-carousel="slide">
        <!-- Carousel wrapper -->
        <div class="relative h-56 overflow-hidden rounded-lg md:h-96">
          <!-- Item 1 -->
          <div class="active duration-700 ease-in-out" data-carousel-item>
            <img
              src="{% static 'hero/item.jpg' %}"
              style="max-height: 80%"
              class="absolute block min-w-fit -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
              alt="..."
            />
          </div>
          <!-- Item 2 -->
          <div class="hidden duration-700 ease-in-out" data-carousel-item>
            <img
              src="{% static 'hero/item2.jpg' %}"
              style="max-height: 80%"
              class="absolute block min-w-fit -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
              alt="..."
            />
          </div>
          <!-- Item 3 -->
          <div class="hidden duration-700 ease-in-out" data-carousel-item>
            <img
              src="{% static 'hero/item3.jpg' %}"
              style="max-height: 80%"
              class="absolute block min-w-fit -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
              alt="..."
            />
          </div>
          <!-- Item 4 -->
          <div class="hidden duration-700 ease-in-out" data-carousel-item>
            <img
              src="{% static 'hero/item4.jpg' %}"
              style="max-height: 80%"
              class="absolute block min-w-fit -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
              alt="..."
            />
          </div>
          <!-- Item 5 -->
          <div class="hidden duration-700 ease-in-out" data-carousel-item>
            <img
              src="{% static 'hero/item5.jpg' %}"
              style="max-height: 80%"
              class="absolute block min-w-fit -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
              alt="..."
            />
          </div>
        </div>
        <!-- Slider indicators -->
        <div class="absolute z-30 flex -translate-x-1/2 bottom-5 left-1/2 space-x-3 rtl:space-x-reverse">
          <button type="button" class="w-3 h-3 rounded-full" aria-current="true" aria-label="Slide 1" data-carousel-slide-to="0"></button>
          <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 2" data-carousel-slide-to="1"></button>
          <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 3" data-carousel-slide-to="2"></button>
          <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 4" data-carousel-slide-to="3"></button>
          <button type="button" class="w-3 h-3 rounded-full" aria-current="false" aria-label="Slide 5" data-carousel-slide-to="4"></button>
        </div>
        <!-- Slider controls -->
        <button
          type="button"
          class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
          data-carousel-prev
        >
          <span
            class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"
          >
            <svg
              class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 6 10"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 1 1 5l4 4"
              />
            </svg>
            <span class="sr-only">Previous</span>
          </span>
        </button>
        <button
          type="button"
          class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
          data-carousel-next
        >
          <span
            class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none"
          >
            <svg
              class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 6 10"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m1 9 4-4-4-4"
              />
            </svg>
            <span class="sr-only">Next</span>
          </span>
        </button>
      </div>
      <div class="mx-auto max-w-2xl px-4 py-6 sm:px-3 sm:py-3 lg:max-w-7xl lg:px-8">
        <h2 class="text-2xl font-bold tracking-tight text-gray-900">
          Sherry Products
        </h2>

        <div
          class="mt-6 grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8"
        >
          {% for product in products %}
          <div
            class="w-72 bg-white shadow-md rounded-xl duration-500 hover:scale-105 hover:shadow-xl"
          >
            <a 
              href="#"
              class="open-modal"
              data-id="{{ product.id }}"
              data-title="{{ product.title }}"
              data-image="{{ product.image }}"
              data-description="{{ product.description }}"
              data-price="{{ product.price }}"
            >
              <img
                src="{{ product.image }}"
                alt="Product"
                class="h-80 w-72 object-cover rounded-t-xl"
              />
              <div class="px-4 py-3 w-72">
                <span class="text-gray-400 mr-3 uppercase text-xs"
                  >{{ product.category }}</span
                >
                <p class="text-lg font-bold text-black truncate block capitalize">
                  <a
                    href="#"
                    class="open-modal"
                    data-id="{{ product.id }}"
                    data-title="{{ product.title }}"
                    data-image="{{ product.image }}"
                    data-description="{{ product.description }}"
                    data-price="{{ product.price }}"
                  >
                    {{ product.title }}
                  </a>
                </p>
                <div class="flex items-center">
                  <p class="text-lg font-semibold text-black cursor-auto my-3">
                    ${{ product.price }}
                  </p>
                  <a
                    href="{% url 'add_to_cart' product.id %}"
                    class="ml-auto"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      fill="currentColor"
                      class="bi bi-bag-plus"
                      viewBox="0 0 16 16"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M8 7.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0v-1.5H6a.5.5 0 0 1 0-1h1.5V8a.5.5 0 0 1 .5-.5z"
                      />
                      <path
                        d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"
                      />
                    </svg>
                  </a>
                </div>
              </div>
            </a>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    <!-- Modal -->
    <div
      id="product-modal"
      class="relative z-10 hidden"
      role="dialog"
      aria-modal="true"
    >
      <div
        class="fixed inset-0 bg-gray-500/75 transition-opacity"
        aria-hidden="true"
      ></div>
      <div class="fixed inset-0 z-10 flex items-center justify-center p-4">
        <div
          class="relative flex w-full max-w-2xl flex-col bg-white rounded-lg shadow-xl transition transform"
        >
          <!-- Close Button -->
          <button
            type="button"
            class="absolute right-4 top-4 text-gray-400 hover:text-gray-500 close-modal"
          >
            <span class="sr-only">Close</span>
            <svg
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18 18 6M6 6l12 12"
              />
            </svg>
          </button>

          <!-- Modal Content -->
          <div
            class="grid w-full grid-cols-1 items-start gap-x-6 gap-y-8 p-6 sm:grid-cols-12 lg:gap-x-8"
          >
            <img
              id="modal-image"
              src=""
              alt=""
              class="aspect-[2/3] w-full rounded-lg bg-gray-100 object-cover sm:col-span-4 lg:col-span-5"
            />
            <div class="sm:col-span-8 lg:col-span-7">
              <h2
                id="modal-title"
                class="text-2xl font-bold text-gray-900 sm:pr-12"
              ></h2>

              <section aria-labelledby="information-heading" class="mt-2">
                <h3 id="information-heading" class="sr-only">
                  Product information
                </h3>
                <p id="modal-price" class="text-2xl text-gray-900"></p>
              </section>

              <section aria-labelledby="description-heading" class="mt-6">
                <h3 id="description-heading" class="sr-only">Description</h3>
                <p id="modal-description" class="text-sm text-gray-500"></p>
                <p id="modal-id" class="text-sm text-gray-500"></p>
              </section>
              <a
                href="#"
                id="modal-add-to-cart"
                class="mt-6 flex w-full items-center justify-center rounded-md bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
              >
                <svg
                  class="w-3.5 h-3.5 me-2"
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="currentColor"
                  viewBox="0 0 18 21"
                >
                  <path
                    d="M15 12a1 1 0 0 0 .962-.726l2-7A1 1 0 0 0 17 3H3.77L3.175.745A1 1 0 0 0 2.208 0H1a1 1 0 0 0 0 2h.438l.6 2.255v.019l2 7 .746 2.986A3 3 0 1 0 9 17a2.966 2.966 0 0 0-.184-1h2.368c-.118.32-.18.659-.184 1a3 3 0 1 0 3-3H6.78l-.5-2H15Z"
                  />
                </svg>
                Add to cart
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.querySelectorAll(".open-modal").forEach((button) => {
      button.addEventListener("click", (event) => {
        event.preventDefault();

        const id = button.getAttribute("data-id");
        const title = button.getAttribute("data-title");
        const image = button.getAttribute("data-image");
        const description = button.getAttribute("data-description");
        const price = button.getAttribute("data-price");

        document.getElementById("modal-title").textContent = title;
        document.getElementById("modal-image").src = image;
        document.getElementById("modal-image").alt = title;
        document.getElementById("modal-description").textContent = description;
        document.getElementById("modal-price").textContent = `$${price}`;
        document.getElementById("modal-add-to-cart").href = `/cart/add/${id}/`;

        document.getElementById("product-modal").classList.remove("hidden");
      });
    });
    document.querySelectorAll(".close-modal").forEach((button) => {
      button.addEventListener("click", () => {
        document.getElementById("product-modal").classList.add("hidden");
      });
    });
    document.addEventListener("DOMContentLoaded", function () {
      const carousel = document.querySelector("[data-carousel='slide']");
      const items = carousel.querySelectorAll("[data-carousel-item]");
      const indicators = carousel.querySelectorAll("[data-carousel-slide-to]");
      let currentIndex = 0;
      const intervalTime = 5000;
      let autoplayInterval;

      function showSlide(index) {
        items.forEach((item) => item.classList.add("hidden"));
        indicators.forEach((indicator) =>
          indicator.setAttribute("aria-current", "false")
        );

        items[index].classList.remove("hidden");
        items[index].classList.add("active");
        indicators[index].setAttribute("aria-current", "true");
      }

      function nextSlide() {
        currentIndex = (currentIndex + 1) % items.length;
        showSlide(currentIndex);
      }

      function prevSlide() {
        currentIndex = (currentIndex - 1 + items.length) % items.length;
        showSlide(currentIndex);
      }

      function startAutoplay() {
        autoplayInterval = setInterval(nextSlide, intervalTime);
      }

      function stopAutoplay() {
        clearInterval(autoplayInterval);
      }

      const nextButton = carousel.querySelector("[data-carousel-next]");
      const prevButton = carousel.querySelector("[data-carousel-prev]");
      nextButton.addEventListener("click", () => {
        stopAutoplay();
        nextSlide();
        startAutoplay();
      });
      prevButton.addEventListener("click", () => {
        stopAutoplay();
        prevSlide();
        startAutoplay();
      });

      startAutoplay();

      carousel.addEventListener("mouseenter", stopAutoplay);
      carousel.addEventListener("mouseleave", startAutoplay);
    });
  </script>

{% endblock %}
